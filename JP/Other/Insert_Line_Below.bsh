int caretPos = textArea.getCaretPosition();
buffer.insert(Math.min(textArea.getLineEndOffset(textArea.getCaretLine()),
                       buffer.getLength()),
              "\n");
textArea.setCaretPosition(caretPos);
